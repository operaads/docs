<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OperaAds Cookie mapping Integration Guide for Suppliers | OperaAds</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="description" content="OperaAds Documentations">
    
    <link rel="preload" href="/assets/css/0.styles.b51db3ef.css" as="style"><link rel="preload" href="/assets/js/app.4b87ebb3.js" as="script"><link rel="preload" href="/assets/js/2.71e54edd.js" as="script"><link rel="preload" href="/assets/js/26.2bd5d665.js" as="script"><link rel="prefetch" href="/assets/js/10.50c865de.js"><link rel="prefetch" href="/assets/js/11.fdd3d066.js"><link rel="prefetch" href="/assets/js/12.79fbe4a2.js"><link rel="prefetch" href="/assets/js/13.f88dd3f2.js"><link rel="prefetch" href="/assets/js/14.f1d14200.js"><link rel="prefetch" href="/assets/js/15.f1e1f3a3.js"><link rel="prefetch" href="/assets/js/16.d40906ec.js"><link rel="prefetch" href="/assets/js/17.2bff3839.js"><link rel="prefetch" href="/assets/js/18.523a2675.js"><link rel="prefetch" href="/assets/js/19.0152aa44.js"><link rel="prefetch" href="/assets/js/20.c1bbc825.js"><link rel="prefetch" href="/assets/js/21.5b50c471.js"><link rel="prefetch" href="/assets/js/22.8a818f58.js"><link rel="prefetch" href="/assets/js/23.556fdbbe.js"><link rel="prefetch" href="/assets/js/24.c96e45db.js"><link rel="prefetch" href="/assets/js/25.5af84591.js"><link rel="prefetch" href="/assets/js/27.3a28fd46.js"><link rel="prefetch" href="/assets/js/28.5041d7ea.js"><link rel="prefetch" href="/assets/js/29.20d16b5a.js"><link rel="prefetch" href="/assets/js/3.7e4a4551.js"><link rel="prefetch" href="/assets/js/30.950cf7e8.js"><link rel="prefetch" href="/assets/js/31.86b71f1e.js"><link rel="prefetch" href="/assets/js/32.6151563e.js"><link rel="prefetch" href="/assets/js/33.a92eebe0.js"><link rel="prefetch" href="/assets/js/34.256c841b.js"><link rel="prefetch" href="/assets/js/35.d72723b5.js"><link rel="prefetch" href="/assets/js/36.43c2d0f4.js"><link rel="prefetch" href="/assets/js/37.8214dcea.js"><link rel="prefetch" href="/assets/js/38.ddfa14c0.js"><link rel="prefetch" href="/assets/js/39.85478932.js"><link rel="prefetch" href="/assets/js/4.2c17db94.js"><link rel="prefetch" href="/assets/js/40.abcee4c5.js"><link rel="prefetch" href="/assets/js/41.4a9e67b3.js"><link rel="prefetch" href="/assets/js/42.b913cc8a.js"><link rel="prefetch" href="/assets/js/43.9fc27d2a.js"><link rel="prefetch" href="/assets/js/44.0b4a461c.js"><link rel="prefetch" href="/assets/js/45.7c7f071f.js"><link rel="prefetch" href="/assets/js/46.941f67c5.js"><link rel="prefetch" href="/assets/js/47.26d51a41.js"><link rel="prefetch" href="/assets/js/48.f484ad6d.js"><link rel="prefetch" href="/assets/js/49.3aa0aa9a.js"><link rel="prefetch" href="/assets/js/5.a40e0871.js"><link rel="prefetch" href="/assets/js/50.a7cf6870.js"><link rel="prefetch" href="/assets/js/51.5e483601.js"><link rel="prefetch" href="/assets/js/52.0d72c1b4.js"><link rel="prefetch" href="/assets/js/53.32fe382a.js"><link rel="prefetch" href="/assets/js/54.3d5f4ca8.js"><link rel="prefetch" href="/assets/js/55.02464af1.js"><link rel="prefetch" href="/assets/js/56.08d3e1d5.js"><link rel="prefetch" href="/assets/js/57.d236e503.js"><link rel="prefetch" href="/assets/js/6.7d3afb54.js"><link rel="prefetch" href="/assets/js/7.0694e902.js"><link rel="prefetch" href="/assets/js/8.13224269.js"><link rel="prefetch" href="/assets/js/9.36baf72a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b51db3ef.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/OperaAds_Icon.png" alt="OperaAds" class="logo"> <span class="site-name can-hide">OperaAds</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="OperaAds for Supply Partners" class="dropdown-title"><span class="title">For Suppliers</span> <span class="arrow down"></span></button> <button type="button" aria-label="OperaAds for Supply Partners" class="mobile-dropdown-title"><span class="title">For Suppliers</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ofs/js/" class="nav-link">
  JS SDK
</a></li><li class="dropdown-item"><!----> <a href="/ofs/android/" class="nav-link">
  Android SDK
</a></li><li class="dropdown-item"><!----> <a href="/ofs/vast-tag/" class="nav-link">
  Vast Tag
</a></li><li class="dropdown-item"><!----> <a href="/ofs/openrtb/" class="nav-link">
  OpenRTB
</a></li><li class="dropdown-item"><!----> <a href="/ofs/header-bidding/" class="nav-link">
  Header Bidding
</a></li><li class="dropdown-item"><!----> <a href="/ofs/cookie-sync/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Cookie Mapping
</a></li><li class="dropdown-item"><!----> <a href="/ofs/user-sync/" class="nav-link">
  User Sync
</a></li><li class="dropdown-item"><!----> <a href="/ofs/report-api/" class="nav-link">
  Report API
</a></li><li class="dropdown-item"><!----> <a href="/ofs/process/" class="nav-link">
  Onboarding Process
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="OperaAds for Demand Partners" class="dropdown-title"><span class="title">For Buyers</span> <span class="arrow down"></span></button> <button type="button" aria-label="OperaAds for Demand Partners" class="mobile-dropdown-title"><span class="title">For Buyers</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ofd/process/" class="nav-link">
  Onboarding Process
</a></li><li class="dropdown-item"><!----> <a href="/ofd/cookie-sync/" class="nav-link">
  Cookie Sync
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ofs/cookie-sync/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh-CN/" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/operaads/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="OperaAds for Supply Partners" class="dropdown-title"><span class="title">For Suppliers</span> <span class="arrow down"></span></button> <button type="button" aria-label="OperaAds for Supply Partners" class="mobile-dropdown-title"><span class="title">For Suppliers</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ofs/js/" class="nav-link">
  JS SDK
</a></li><li class="dropdown-item"><!----> <a href="/ofs/android/" class="nav-link">
  Android SDK
</a></li><li class="dropdown-item"><!----> <a href="/ofs/vast-tag/" class="nav-link">
  Vast Tag
</a></li><li class="dropdown-item"><!----> <a href="/ofs/openrtb/" class="nav-link">
  OpenRTB
</a></li><li class="dropdown-item"><!----> <a href="/ofs/header-bidding/" class="nav-link">
  Header Bidding
</a></li><li class="dropdown-item"><!----> <a href="/ofs/cookie-sync/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Cookie Mapping
</a></li><li class="dropdown-item"><!----> <a href="/ofs/user-sync/" class="nav-link">
  User Sync
</a></li><li class="dropdown-item"><!----> <a href="/ofs/report-api/" class="nav-link">
  Report API
</a></li><li class="dropdown-item"><!----> <a href="/ofs/process/" class="nav-link">
  Onboarding Process
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="OperaAds for Demand Partners" class="dropdown-title"><span class="title">For Buyers</span> <span class="arrow down"></span></button> <button type="button" aria-label="OperaAds for Demand Partners" class="mobile-dropdown-title"><span class="title">For Buyers</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ofd/process/" class="nav-link">
  Onboarding Process
</a></li><li class="dropdown-item"><!----> <a href="/ofd/cookie-sync/" class="nav-link">
  Cookie Sync
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ofs/cookie-sync/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh-CN/" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/operaads/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Guide</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ofs/cookie-sync/" aria-current="page" class="active sidebar-link">OperaAds Cookie mapping Integration Guide for Suppliers</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ofs/cookie-sync/#cookie-mapping" class="sidebar-link">Cookie Mapping</a></li><li class="sidebar-sub-header"><a href="/ofs/cookie-sync/#concepts" class="sidebar-link">Concepts</a></li><li class="sidebar-sub-header"><a href="/ofs/cookie-sync/#getting-started" class="sidebar-link">Getting Started</a></li><li class="sidebar-sub-header"><a href="/ofs/cookie-sync/#cookie-mapping-service-workflow" class="sidebar-link">Cookie Mapping Service Workflow</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="operaads-cookie-mapping-integration-guide-for-suppliers"><a href="#operaads-cookie-mapping-integration-guide-for-suppliers" class="header-anchor">#</a> OperaAds Cookie mapping Integration Guide for Suppliers</h1> <h2 id="cookie-mapping"><a href="#cookie-mapping" class="header-anchor">#</a> Cookie Mapping</h2> <p>Cookie Mapping is a feature that enables you to map your cookie—for example, an ID for a user that browsed your website—with a corresponding OperaAds User ID, and construct user lists that can help advertisers make more effective bidding choices. This guide describes concepts used in Cookie Mapping, as well as Cookie Mapping workflow.</p> <h2 id="concepts"><a href="#concepts" class="header-anchor">#</a> Concepts</h2> <h3 id="what-is-cookie-mapping"><a href="#what-is-cookie-mapping" class="header-anchor">#</a> What is Cookie Mapping?</h3> <p>In the context of digital advertising, OperaAds identifies users with cookies that belong to the adx.opera.com domain, and suppliers participating in Real-Time Bidding may have their own domain where they identify some set of users they would like to show ads. Cookie Mapping enables the suppliers to map their cookies with OperaAds', such that OperaAds can determine whether an impression sent in a bid request is associated with one of users being targeted, OperaAds will receive a OperaAds User ID in the bid request ( <code>req.user.buyeruid</code> field).</p> <p>The cookie mapping service described in this guide facilitates the creation and maintenance of the association between a supplier's cookie and the OperaAds User ID.</p> <h3 id="mapping-table"><a href="#mapping-table" class="header-anchor">#</a> Mapping Table</h3> <p>A mapping table can be used to map an ID or other data from one domain to another. Suppliers should maintain the mapping table between supplier uid and OperaAds uid. Once a mapping has been established, in OperaAds' OpenRTB implementation, BidRequest.user.buyeruid should be set to OperaAds user id.</p> <h2 id="getting-started"><a href="#getting-started" class="header-anchor">#</a> Getting Started</h2> <p>OperaAds Cookie Mapping URL is like <code>https://t.adx.opera.com/pub/sync?pubid=${publisher_id}</code>. Suppliers should contact OperaAds account manager to get the publisher id，and provide their cookie mapping url, which contains ${OPERA_UID} macro. Suppose publisher_id is <em>pub123</em>, supplier cookie mapping url is https://publisher.adnetwork.com/pixel?uid=${OPERA_UID}, in this case OperaAds Cookie Mapping URL is <code>https://t.adx.opera.com/pub/sync?pubid=pub123</code>.</p> <h3 id="macros-supported"><a href="#macros-supported" class="header-anchor">#</a> Macros supported</h3> <table><thead><tr><th>Macros</th> <th>Description</th></tr></thead> <tbody><tr><td>${GDPR}</td> <td>Flag that indicates whether or not the request is subject to GDPR regulations. 0 = No, 1 = Yes, omission indicates Unknown</td></tr> <tr><td>${GDPR_CONSENT}</td> <td>GDPR consent string, which should follow TCFv2 standard</td></tr> <tr><td>${US_PRIVACY}</td> <td>Communicates signals regarding consumer privady under US privacy regulation.</td></tr> <tr><td>${COPPA}</td> <td>California Consumer Privacy Act</td></tr> <tr><td>${OPERA_UID}</td> <td>Opera User ID</td></tr> <tr><td>${OPERA_UID_ENCODED}</td> <td>Opera User ID encoded with base64</td></tr></tbody></table> <h2 id="cookie-mapping-service-workflow"><a href="#cookie-mapping-service-workflow" class="header-anchor">#</a> Cookie Mapping Service Workflow</h2> <h3 id="step-1-place-operaads-map-tag-directed-to-operaads-cookie-mapping-url"><a href="#step-1-place-operaads-map-tag-directed-to-operaads-cookie-mapping-url" class="header-anchor">#</a> Step 1: Place OperaAds map tag directed to OperaAds Cookie Mapping URL</h3> <p>In order to initiate this flow, a supplier must place OperaAds map tag such that it renders in the user's browser. The map tag will direct the user's browser to OperaAds Cookie Mapping URL. Loot at OperaAds map tag below:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://t.adx.opera.com/pub/sync?pubid=pub123&amp;gdpr=${GDPR}&amp;consent=${GDPR_CONSENT}&amp;us_privacy=${US_PRIVACY}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>Suppliers should expand user privacy macro in the map tag. For example, expand ${GDPR} with 0 or 1, expand ${GDPR_CONSENT} with <a href="https://github.com/InteractiveAdvertisingBureau/GDPR-Transparency-and-Consent-Framework/blob/master/TCFv2/TCF-Implementation-Guidelines.md" target="_blank" rel="noopener noreferrer">gdpr consent string<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, expand ${US_PRIVACY} with <a href="https://github.com/InteractiveAdvertisingBureau/USPrivacy/blob/master/CCPA/US%20Privacy%20String.md" target="_blank" rel="noopener noreferrer">us privacy string<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>When loading in the user's browser, it will request a pixel from the OperaAds Cookie Mapping URL. This request will contain cookie in the HTTP header, which should be extracted for the next step.</p> <h3 id="step-2-redirect-to-supplier-cookie-mapping-url"><a href="#step-2-redirect-to-supplier-cookie-mapping-url" class="header-anchor">#</a> Step 2: Redirect to supplier' Cookie Mapping URL</h3> <p>OperaAds' Cookie Mapping service will query publisher’ Cookie Mapping URL from backend according to paramter <code>pubid</code>, and redirects to that url after replacing macro ${OPERA_UID} with real opera uid ( if the macro does not exist, query parameter <code>operaUid</code> will be added into the redirect url). The redirect URL might look like the following:</p> <div class="language-url extra-class"><pre class="language-url"><code><span class="token scheme">https<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host">publisher.adnetwork.com</span></span><span class="token path"><span class="token path-separator">/</span>pixel</span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">uid</span>=<span class="token value">4e93fa9e-86e3-11eb-8dcd-0242ac130003</span></span></span>
</code></pre></div><p>Or if the macro ${OPERA_UID} does not exist, the redirect URL might look like the following:</p> <div class="language-url extra-class"><pre class="language-url"><code><span class="token scheme">https<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host">publisher.adnetwork.com</span></span><span class="token path"><span class="token path-separator">/</span>pixel</span><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">operaUid</span>=<span class="token value">4e93fa9e-86e3-11eb-8dcd-0242ac130003</span></span></span>
</code></pre></div><h3 id="step-3-user-s-browser-is-redirected-to-supplier-cookie-mapping-service"><a href="#step-3-user-s-browser-is-redirected-to-supplier-cookie-mapping-service" class="header-anchor">#</a> Step 3: User's browser is redirected to supplier' Cookie Mapping service</h3> <p>Supplier will receive a redirect containing opera uid, in addition to its own cookie in the HTTP headers.</p> <h3 id="step-4-supplier-serves-pixel-on-the-end"><a href="#step-4-supplier-serves-pixel-on-the-end" class="header-anchor">#</a> Step 4: Supplier serves pixel on the end</h3> <p>If the cookie mapping operation is done, supplier should serve a 1x1 transparent pixel by default, and the workflow will end here. Bid requests for this user should set BidRequest.user.buyeruid with opera uid for OperaAds' OpenRTB implementation.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.4b87ebb3.js" defer></script><script src="/assets/js/2.71e54edd.js" defer></script><script src="/assets/js/26.2bd5d665.js" defer></script>
  </body>
</html>
